<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="robots" content="noindex, nofollow">
  <meta name="googlebot" content="noindex, nofollow">

      <script type="text/javascript" src="//rawgit.com/amark/gun/master/gun.js"></script>
      <script type="text/javascript" src="include/cytoscape.min.js"></script>
      <script type="text/javascript" src="include/cytoscape-cose-bilkent.js"></script>
      <script type="text/javascript" src="include/gGraph-v2.js"></script>
      <script type="text/javascript" src="include/gIntrospect.js"></script>
      <script type="text/javascript" src="include/gSetup.js"></script>

      <link rel="stylesheet" type="text/css" href="include/simple-console.css">
      <script type="text/javascript" src="include/simple-console.js"></script>
    
  <style type="text/css">
     html, body {
                height: 100%;
                width: 100%;
            }
            body {
               height: 100%;
               margin: 0;
               display: flex;
               flex: 1;
            }
            #graph {
                margin-top: 10px;
                width: 70%;
                height: 80%;
            }
            .simple-console {
                margin-top: 50px;
                width: 50%;
                height: 100%;
                display: block;
            }
            pre {
              font-weight: bold;
              z-index:9999999;
            }
            code {
                position: absolute;
                right:  2em;
                bottom: 1.5em;
                pointer-events: none;
            }

            .buttons {
                position: absolute;
                right:  1em;
                top: 0.75em;
                z-index: 100;
            }
  </style>

  <title>GunDB Graph Live</title>

	<script type='text/javascript'>//<![CDATA[
	window.onload=function(){
	window.gEx1 = {
	    setUpExample: function() {
		g.get('person/john').put({name:'john doe', gender:'m'});
		g.get('person/anne').put({name:'anne smith', gender:'f'});
		    renderGraph()
	    },
	    setUpCouple: function() {
		g.get('person/anne').get('married_to').put( g.get('person/john'));
		    renderGraph()
	    }
	};
 
gSetup(false, true);

var con = new SimpleConsole({
	placeholder: "Gun Console (g)",
	handleCommand: function(command){
		try {
			console.log(eval(command));
			con.clear();
                        renderGraph(); 
		} catch(error) {
			con.error(error);
		}
	},
	autofocus: true, // if the console is to be the primary interface of the page
	storageID: "app-console"
});

// add the console to the page
document.body.appendChild(con.element);

// show any uncaught errors
con.handleUncaughtErrors();
            
window.resetData = function() {
                g._.graph = {};
                gi = gIntrospect(g);
                renderGraph = gGraph(g, gi, '#graph');
}

window.logData = function() {
                gi.logAll();
}

setTimeout(function() {
                var gi = gIntrospect(g);
                window.gi = gi;
                window.renderGraph = gGraph(g, gi, '#graph');
}, 100);
}//]]> 

</script>

  
</head>

<body>
  <div id="graph"></div>

        <div class="buttons">
	    <button onclick="window.gEx1.setUpExample()">Add Pair</button>
	    <button onclick="window.gEx1.setUpCouple()">Join Pair</button>
            <button onclick="renderGraph()">Update Graph</button>
	    <button onclick="window.resetData()">Clear Graph</button>
        </div>

 <code>Example Syntax: <pre>
g.get('person/me').put({name: 'Lorenzo'});
        </pre></code>
  
  <script>
  // tell the embed parent frame the height of the content
  if (window.parent && window.parent.parent){
    window.parent.parent.postMessage(["resultsFrame", {
      height: document.body.getBoundingClientRect().height,
      slug: "ca4womwf"
    }], "*")
  }
</script>

</body>
</html>
