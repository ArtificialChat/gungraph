<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="robots" content="noindex, nofollow">
  <meta name="googlebot" content="noindex, nofollow">

      <script type="text/javascript" src="//rawgit.com/amark/gun/master/gun.js"></script>
      <script type="text/javascript" src="//rawgit.com/cytoscape/cytoscape.js/master/dist/cytoscape.min.js"></script>
      <script type="text/javascript" src="//rawgit.com/cytoscape/cytoscape.js-cose-bilkent/master/cytoscape-cose-bilkent.js"></script>
      <script type="text/javascript" src="https://rawgit.com/JosePedroDias/serve-gundb/master/gGraph-v2.js"></script>
      <script type="text/javascript" src="https://rawgit.com/JosePedroDias/serve-gundb/master/gIntrospect.js"></script>
      <script type="text/javascript" src="https://rawgit.com/JosePedroDias/serve-gundb/master/gSetup.js"></script>

      <link rel="stylesheet" type="text/css" href="https://rawgit.com/1j01/simple-console/gh-pages/simple-console.css">
      <script type="text/javascript" src="https://rawgit.com/1j01/simple-console/gh-pages/simple-console.js"></script>
    
  <style type="text/css">
     html, body {
                height: 100%;
                width: 100%;
            }
            body {
               height: 100%;
               margin: 0;
               display: flex;
               flex: 1;
            }
            #graph {
                margin-top: 10px;
                width: 130%;
                height: 100%;
                display: block;
            }
            .simple-console {
                margin-top: 50px;
                width: 50%;
                height: 100%;
                display: block;
                
            }
            pre {
              font-weight: bold;
              z-index:9999999;
            }
            code {
                position: absolute;
                right:  2em;
                bottom: 1.5em;
                pointer-events: none;
            }

            .buttons {
                position: absolute;
                right:  1em;
                top: 0.75em;
                z-index: 100;
            }
  </style>

  <title>GunDB Graph Live</title>

	<script type='text/javascript'>//<![CDATA[
	window.onload=function(){
	var gEx1 = {
	    setUpExample: function() {
		g.get('person/john').put({name:'john doe', age:35, gender:'m'});
		g.get('person/anne').put({name:'anne smith', age:32, gender:'f'});
	    }
	};
 
gSetup(false, true);
gEx1.setUpExample();
var con = new SimpleConsole({
	placeholder: "Gun Console (g)",
	handleCommand: function(command){
		try {
			con.log(eval(command));
      renderGraph()
		} catch(error) {
			con.error(error);
		}
	},
	autofocus: true, // if the console is to be the primary interface of the page
	storageID: "app-console"
});

// add the console to the page
document.body.appendChild(con.element);

// show any uncaught errors
con.handleUncaughtErrors();
            
function resetData() {
                g._.graph = {};
                gi = gIntrospect(g);
                renderGraph = gGraph(g, gi, '#graph');
}

function logData() {
                gi.logAll();
}

setTimeout(function() {
                var gi = gIntrospect(g);
                window.gi = gi;
                window.renderGraph = gGraph(g, gi, '#graph');
}, 100);
}//]]> 

</script>

  
</head>

<body>
  <div id="graph"></div>

        <div class="buttons">
            <button onclick="resetData()">reset data</button>
            <button onclick="logData()">log data</button>
            <button onclick="renderGraph()">update graph</button>
        </div>

 <code>Marry John and Anne: <pre>
g.get('person/anne').get('married_to').put( g.get('person/john'));
        </pre></code>
  
  <script>
  // tell the embed parent frame the height of the content
  if (window.parent && window.parent.parent){
    window.parent.parent.postMessage(["resultsFrame", {
      height: document.body.getBoundingClientRect().height,
      slug: "ca4womwf"
    }], "*")
  }
</script>

</body>
</html>
